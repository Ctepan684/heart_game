<!DOCTYPE html>
<html>
<head>
    <title>–°–æ–±–µ—Ä–∏ —Å–µ—Ä–¥–µ—á–∫–∏! ‚ù§Ô∏è</title>
    <style>
        body { margin: 0; overflow: hidden; }
        canvas { display: block; background: #fff; }
    </style>
</head>
<body>
    <canvas id="gameCanvas"></canvas>
    <script>
        const canvas = document.getElementById("gameCanvas");
        const ctx = canvas.getContext("2d");
        canvas.width = window.innerWidth;
        canvas.height = window.innerHeight;

        // –ò–≥—Ä–æ–∫
        const player = {
            x: canvas.width / 2,
            y: canvas.height - 70,
            size: 40,
            speed: 5,
            color: "#FFB6C1"
        };

        // –°–µ—Ä–¥–µ—á–∫–∏
        const hearts = [];
        const heartSize = 25;
        let heartsCollected = 0;
        const heartsNeeded = 7;

        // –¢–æ—Ä—Ç–∏–∫
        const cake = {
            x: Math.random() * (canvas.width - 60),
            y: Math.random() * (canvas.height - 100),
            size: 60,
            appeared: false,
            color: "#8B4513"
        };

        // –°–æ–∑–¥–∞—ë–º —Å–µ—Ä–¥–µ—á–∫–∏
        for (let i = 0; i < 15; i++) {
            hearts.push({
                x: Math.random() * (canvas.width - heartSize),
                y: Math.random() * (canvas.height - heartSize - 100),
                color: "#FF0000"
            });
        }

        // –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ (–∫–∞—Å–∞–Ω–∏—è–º–∏)
        let touchX = player.x;
        canvas.addEventListener("touchmove", (e) => {
            e.preventDefault();
            touchX = e.touches[0].clientX;
        });

        // –ò–≥—Ä–æ–≤–æ–π —Ü–∏–∫–ª
        function gameLoop() {
            ctx.clearRect(0, 0, canvas.width, canvas.height);

            // –î–≤–∏–∂–µ–Ω–∏–µ –∏–≥—Ä–æ–∫–∞
            player.x += (touchX - player.x) * 0.1;

            // –†–∏—Å—É–µ–º –∏–≥—Ä–æ–∫–∞ (–∫–æ—Ç—ë–Ω–∫–∞)
            ctx.fillStyle = player.color;
            ctx.fillRect(player.x - player.size/2, player.y - player.size/2, player.size, player.size);

            // –†–∏—Å—É–µ–º —Å–µ—Ä–¥–µ—á–∫–∏
            hearts.forEach((heart, index) => {
                ctx.fillStyle = heart.color;
                drawHeart(heart.x, heart.y, heartSize);

                // –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å–±–æ—Ä–∞
                if (
                    Math.abs(player.x - heart.x) < player.size/2 + heartSize/2 &&
                    Math.abs(player.y - heart.y) < player.size/2 + heartSize/2
                ) {
                    hearts.splice(index, 1);
                    heartsCollected++;
                }
            });

            // –¢–æ—Ä—Ç–∏–∫ –ø–æ—Å–ª–µ —Å–±–æ—Ä–∞ –≤—Å–µ—Ö —Å–µ—Ä–¥–µ—á–µ–∫
            if (heartsCollected >= heartsNeeded && !cake.appeared) {
                cake.appeared = true;
            }

            // –†–∏—Å—É–µ–º —Ç–æ—Ä—Ç–∏–∫
            if (cake.appeared) {
                ctx.fillStyle = cake.color;
                ctx.fillRect(cake.x, cake.y, cake.size, cake.size);
                ctx.fillStyle = "#FFB6C1";
                ctx.fillRect(cake.x, cake.y - 10, cake.size, 10);

                // –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ–±–µ–¥—ã
                if (
                    Math.abs(player.x - (cake.x + cake.size/2)) < player.size/2 + cake.size/2 &&
                    Math.abs(player.y - (cake.y + cake.size/2)) < player.size/2 + cake.size/2
                ) {
                    ctx.font = "30px Arial";
                    ctx.fillStyle = "#FF0000";
                    ctx.fillText("–¢—ã –ø–æ–±–µ–¥–∏–ª–∞! üéÇ", canvas.width/2 - 150, canvas.height/2);
                    return; // –û—Å—Ç–∞–Ω–æ–≤–∫–∞ –∏–≥—Ä—ã
                }
            }

            // –°—á—ë—Ç—á–∏–∫
            ctx.font = "20px Arial";
            ctx.fillStyle = "#000000";
            ctx.fillText(`–°–µ—Ä–¥–µ—á–µ–∫: ${heartsCollected}/${heartsNeeded}`, 20, 30);

            requestAnimationFrame(gameLoop);
        }

        // –†–∏—Å—É–µ—Ç —Å–µ—Ä–¥–µ—á–∫–æ
        function drawHeart(x, y, size) {
            ctx.beginPath();
            ctx.moveTo(x, y);
            ctx.bezierCurveTo(x, y - size/2, x - size, y - size/2, x - size, y);
            ctx.bezierCurveTo(x - size, y + size/3, x, y + size, x, y + size);
            ctx.bezierCurveTo(x, y + size, x + size, y + size/3, x + size, y);
            ctx.bezierCurveTo(x + size, y - size/2, x, y - size/2, x, y);
            ctx.fill();
        }

        gameLoop();
    </script>
</body>
</html>
